library(phyloseq)
source("https://raw.githubusercontent.com/mahendra-mariadassou/phyloseq-extended/master/load-extra-functions.R")
data <- "data.Rdata"
load(data)
data <- "data/data.Rdata"
load(data)
distance <-"data/Bray_Curtis.tsv"
A <- read.table(file=basename(distance), row.names=1)
A <- read.table(file=distance, row.names=1)
dist <- as.dist(A)
ord <- ordinate(data, method ="MDS", distance = dist)
p1 <- plot_ordination(data, ord, color = "EnvType") + theme_bw() + ggtitle("MDS")+ theme(plot.title = element_text(hjust = 0.5))
plot(p1)
p2 <- plot_samples(data, ord, color = "EnvType") + theme_bw()+ ggtitle("MDS")+ theme(plot.title = element_text(hjust = 0.5))
plot(p2)
p22 <- p2 +  stat_ellipse(aes(group = EnvType))
plot(p22)
lowCol <- "#1a9850" # green
midCol <-  "#ffffbf" # yellow
highCol <- "#d73027" # red
naCol <- "white" # white!
plot_heatmap(data) + scale_fill_gradient2(low = lowCol, mid = midCol, high = highCol, na.value = naCol, trans = log_trans(4), midpoint = log(100, base = 4))+ facet_grid(~EnvType, scales = "free_x")"+ theme(plot.title = element_text(hjust = 0.5)) + ggtitle("Heatmap plot")
plot(p3)
plot_heatmap(data)
plot_heatmap(data) + scale_fill_gradient2(low = lowCol
)
plot_heatmap(data) + scale_fill_gradient2(low = lowCol, mid = midCol, high = highCol, na.value = naCol, trans = log_trans(4), midpoint = log(100, base = 4))
plot_heatmap(data) + scale_fill_gradient2(low = lowCol, mid = midCol, high = highCol, na.value = naCol, trans = log_trans(4), midpoint = log(100, base = 4))+ facet_grid(~EnvType, scales = "free_x")+ theme(plot.title = element_text(hjust = 0.5)) + ggtitle("Heatmap plot")
plot(p3)
plot_heatmap(data) + scale_fill_gradient2(low = lowCol, mid = midCol, high = highCol, na.value = naCol, trans = log_trans(4), midpoint = log(100, base = 4))+ facet_grid(~EnvType, scales = "free_x")+ theme(plot.title = element_text(hjust = 0.5)) + ggtitle("Heatmap plot")
plot(p3)
ord <- ordinate(data, method ="MDS", distance = dist)
p1 <- plot_ordination(data, ord, color = "EnvType") + theme_bw() + ggtitle("MDS")+ theme(plot.title = element_text(hjust = 0.5))
plot(p1)
p2 <- plot_samples(data, ord, color = "EnvType") + theme_bw()+ ggtitle("MDS")+ theme(plot.title = element_text(hjust = 0.5))
plot(p2)
p22 <- p2 +  stat_ellipse(aes(group = EnvType))
plot(p22)
p3 <- plot_heatmap(data) + scale_fill_gradient2(low = lowCol, mid = midCol, high = highCol, na.value = naCol, trans = log_trans(4), midpoint = log(100, base = 4))+ facet_grid(~EnvType, scales = "free_x") + theme(plot.title = element_text(hjust = 0.5)) + ggtitle("Heatmap plot")
plot(p3)
p3 <- plot_heatmap(data) + scale_fill_gradient2(low = "#ffff00", mid = "#ffa500", high = "#ff0000", na.value = naCol, trans = log_trans(4), midpoint = log(100, base = 4))+ facet_grid(~EnvType, scales = "free_x") + theme(plot.title = element_text(hjust = 0.5)) + ggtitle("Heatmap plot")
plot(p3)
